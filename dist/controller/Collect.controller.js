sap.ui.define(["sap/ui/core/UIComponent","./BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox"],function(t,e,o,i,n){function l(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const a=l(e);const s=a.extend("icl.delivery.controller.Collect",{onAfterRendering:function t(){this.disableComboBox("noWriteCombo2")},onInit:function e(){a.prototype.onInit.call(this);const o=t.getRouterFor(this);o.getRoute("collect").attachMatched(this._initialFunc,this)},_initialFunc:function t(){this.initTableSelections("itemsTable");const e=this.getDelivModel();e.setProperty("/oMaintain/title",delComponent.i18n("collectFrom"));e.setProperty("/oFlags/headerNavBack",true);e.setProperty("/currView","collect");const o=e.getProperty("/oMaintain/collect/currCollect");if(o){this.loadItems(e)}else this.onNavBack()},loadItems:function t(e){void fetch("/mockData/collectItems.JSON").then(t=>t.json()).then(t=>{e.setProperty("/oData/collectItems",t)})},filterItems:function t(e){const n=e.getParameter("newValue"),l=this.getView().byId("itemsTable"),a=l.getBinding("items"),s=[new o("catNum",i.Contains,n)];a.filter(n?s:null)},onStartCollectDialog:function t(e){const o=this.getDelivModel();o.setProperty("/oMaintain/collect/startError",'הפק"ע סגורה');void this.onFragmentHandler(e,"Dialog_StartCollect",true)},startCollect:function t(e){const o=this.getDelivModel();o.setProperty("/oMaintain/share/showStartDialog",true);o.setProperty("/oMaintain/collect/start",true);setTimeout(()=>{void this.cancelFragment(e,"Dialog_StartCollect")},1500)},showBlob:function t(){alert("show blob as url")},onFinishCollect:function t(e){const o=this.getDelivModel();const i=this.getView().byId("itemsTable");if(i.getItems().length===i.getSelectedItems().length){o.setProperty("/oMaintain/collect/endCollect",{materialNum:"123456777"});void this.onFragmentHandler(e,"Dialog_FinishCollect",true)}else n.show("לא סימנת את כל הפריטים")},onPrintFinish:function t(e){const o=this.getDelivModel();o.setProperty("/oMaintain/collect/endCollect/finish",true);o.setProperty("/oMaintain/collect/start",false);void this.cancelFragment(e,"Dialog_FinishCollect")},onDigitalSignDialog:async function t(e){await this.onFragmentHandler(e,"Dialog_DigitSign",true);this.cleanSign();this.attachSignEvent()},attachSignEvent:function t(){const e=sap.ui.getCore().byId("signaturePad");const o=e.getItems()[0];o.attachBrowserEvent("click",()=>{const t=this.getDelivModel();t.setProperty("/oMaintain/collect/sign",true)})},cleanSign:function t(){const e=this.getDelivModel();e.setProperty("/oMaintain/countedForm/signature",true);const o=sap.ui.getCore().byId("signaturePad");const i=o.getItems()[0];i.clear();e.setProperty("/oMaintain/collect/sign",false)},deleteReq:function t(e){this.cancelFragment(e,"Dialog_DeleteReq");this.navTo("main")}});return s});