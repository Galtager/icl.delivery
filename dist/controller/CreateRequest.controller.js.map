{"version":3,"file":"CreateRequest.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","CreateRequest","extend","onInit","_onInit","BaseController.prototype.onInit.call","oRouter","UIComponent","getRouterFor","getRoute","attachMatched","_initialFunc","initTableSelections","deliveryModel","getDelivModel","setProperty","step","searchArmor","_searchArmor","oEvent","query","getParameter","fetch","then","res","json","data","filterItems","filter","item","armorId","length","checked","_checked","li","itemPath","getBindingContext","getPath","items","getProperty","atLeastOne","some","selected","cancelArmor","_cancelArmor","onNavBack","preview","_preview","filterTable","Filter","FilterOperator","EQ","setStep","backToEdit","_backToEdit","_filterTable","table","getView","byId","oBinding","getBinding","_setStep"],"sources":["../../src/controller/CreateRequest.controller.ts"],"sourcesContent":["import BaseController from \"./BaseController\";\r\nimport UIComponent from \"sap/ui/core/UIComponent\";\r\nimport Event from \"sap/ui/base/Event\";\r\nimport { ICollectItem } from \"./MultiCollect.controller\";\r\nimport ListItem from \"sap/ui/core/ListItem\";\r\nimport { ICollectRequest } from \"./Main.controller\";\r\nimport Table from \"sap/m/Table\";\r\nimport ListBinding from \"sap/ui/model/ListBinding\";\r\nimport Filter from \"sap/ui/model/Filter\";\r\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\r\n\r\n/**\r\n * @namespace icl.delivery.controller\r\n */\r\nexport default class CreateRequest extends BaseController {\r\n    onInit() {\r\n        super.onInit();\r\n        const oRouter = UIComponent.getRouterFor(this);\r\n        // eslint-disable-next-line @typescript-eslint/unbound-method\r\n        oRouter.getRoute(\"createRequest\").attachMatched(this._initialFunc, this);\r\n    }\r\n    public _initialFunc() {\r\n        this.initTableSelections('createReqItems')\r\n        const deliveryModel = this.getDelivModel();\r\n        deliveryModel.setProperty('/oFlags/headerNavBack', true);\r\n        deliveryModel.setProperty('/currView', 'createRequest');\r\n        deliveryModel.setProperty('/oMaintain/createReq', { step: '1' });\r\n\r\n    }\r\n    public searchArmor(oEvent: Event) {\r\n        const query = oEvent.getParameter('query') as string\r\n        const deliveryModel = this.getDelivModel();\r\n        void fetch(\"/mockData/collectItems.JSON\")\r\n            .then(res => res.json())\r\n            .then((data: ICollectItem[]) => {\r\n                const filterItems = data.filter(item => item.armorId === query);\r\n                deliveryModel.setProperty('/oMaintain/createReq/armorSel', filterItems.length ? query : '');\r\n                deliveryModel.setProperty('/oData/armorItems', filterItems.length ? filterItems : []);\r\n\r\n            });\r\n\r\n    }\r\n    public checked(oEvent: Event) {\r\n        const deliveryModel = this.getDelivModel();\r\n        const li = oEvent.getParameter('listItem') as ListItem;\r\n        const checked = oEvent.getParameter('selected') as boolean;\r\n        const itemPath = li.getBindingContext('DelModel').getPath();\r\n        deliveryModel.setProperty(`${itemPath}/selected`, checked)\r\n        if (checked)\r\n            deliveryModel.setProperty('/oMaintain/createReq/continue', checked)\r\n        else {\r\n            // check how many selected\r\n            const items = deliveryModel.getProperty('/oData/armorItems') as ICollectItem[];\r\n            const atLeastOne = items.some(item => item.selected);\r\n            deliveryModel.setProperty('/oMaintain/createReq/continue', atLeastOne)\r\n        }\r\n    }\r\n\r\n    public cancelArmor() {\r\n        const deliveryModel = this.getDelivModel();\r\n        this.onNavBack()\r\n        deliveryModel.setProperty('/oData/armorItems', []);\r\n    }\r\n    public preview() {\r\n        this.filterTable(new Filter('selected', FilterOperator.EQ, true));\r\n        this.setStep('2')\r\n    }\r\n    public backToEdit() {\r\n        this.filterTable(null);\r\n        this.setStep('1')\r\n    }\r\n    private filterTable(filter: Filter | null) {\r\n        const table = this.getView().byId('createReqItems') as Table,\r\n            oBinding = table.getBinding(\"items\") as ListBinding;\r\n        oBinding.filter(filter);\r\n    }\r\n    private setStep(step: '1' | '2') {\r\n        const deliveryModel = this.getDelivModel();\r\n        deliveryModel.setProperty('/oMaintain/createReq/step', step);\r\n\r\n    }\r\n}"],"mappings":"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"}