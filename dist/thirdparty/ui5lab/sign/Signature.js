sap.ui.define(["sap/ui/core/Control","./library"],function(t,e){"use strict";var n=t.extend("icl.delivery.thirdparty.ui5lab.sign.Signature",{metadata:{library:"ui5.sign",properties:{height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},backgroundColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgb(221, 221, 221)"},penColor:{type:"sap.ui.core.CSSColor",defaultValue:"black"},penSize:{type:"int",defaultValue:2},editable:{type:"boolean",defaultValue:true}},aggregations:{},associations:{},events:{}},init:function(){},onBeforeRendering:function(){},onAfterRendering:function(){if(this.getEditable()){this._attachEvents()}},exit:function(){this._cleanUp()},_attachEvents:function(){var t=this._getD3SVG();t.on("mousedown",s.bind(this));t.on("mouseup",a);t.on("mouseleave",a);t.on("mousemove",l);t.on("touchstart",s.bind(this));t.on("touchcancel",a);t.on("touchend",a);t.on("touchmove",l)},setPenColor:function(t){this.setProperty("penColor",t,true);return this},setPenSize:function(t){if(t<1){jQuery.sap.log.error("Property 'penSize' cannot be less than 1")}this.setProperty("penSize",t,true);return this},_getD3SVG:function(){return d3.select("#"+this.getId()).select("svg")},_cleanUp:function(){this._getD3SVG().on("mousedown",null);this._getD3SVG().on("mousemove",null);this._getD3SVG().on("mouseup",null);this._getD3SVG().on("mouseleave",null);this._getD3SVG().on("touchstart",null);this._getD3SVG().on("touchcancel",null);this._getD3SVG().on("touchend",null);this._getD3SVG().on("touchmove",null)},getSVGString:function(){return d3.select("#"+this.getId()).html()},setSVGString:function(t){d3.select("#"+this.getId()).node().innerHTML=t;this.setEditable(false);return this},setEditable:function(t){this.setProperty("editable",t,true);if(t){this._attachEvents()}else{this._cleanUp()}return this},clear:function(){this.rerender();return this}});var i=[];var o;var r=false;var u=d3.svg.line().interpolate("bundle").tension(1).x(function(t){return t.x}).y(function(t){return t.y});function s(){r=true;i=[];var t=d3.select(d3.event.target);o=t.append("path").data([i]).attr("fill","none").attr("stroke-linejoin","round").attr("stroke",this.getPenColor()).attr("stroke-width",this.getPenSize()).attr("d",u)}function a(){r=false}function l(){if(r){var t=d3.mouse(this);i.push({x:t[0],y:t[1]});o.attr("d",function(t){return u(t)})}}return n});